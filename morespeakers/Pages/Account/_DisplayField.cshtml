@{
    var field = ViewData["Field"] as string ?? "";
    var pageModel = ViewData["PageModel"] as morespeakers.Pages.Account.IndexModel;
    var fieldName = field.ToLower();
    var displayName = GetDisplayName(field);
    var value = GetFieldValue(pageModel, field);
}

<div class="field-display">
    <div class="d-flex justify-content-between align-items-start">
        <div class="flex-grow-1">
            <label class="form-label fw-medium text-muted small">@displayName</label>
            <div class="field-value">
                @if (field == "Bio" || field == "Goals")
                {
                    <div class="text-break" style="white-space: pre-line;">@(value ?? "Not provided")</div>
                }
                else if (field == "SpeakerTypeId")
                {
                    <div>@(pageModel?.SpeakerType?.Name ?? "Not set") Speaker</div>
                }
                else if (field == "Email")
                {
                    <div>
                        @value
                        @if (!string.IsNullOrEmpty(value))
                        {
                            <i class="bi bi-envelope ms-2 text-muted"></i>
                        }
                    </div>
                }
                else if (field == "PhoneNumber")
                {
                    <div>
                        @(value ?? "Not provided")
                        @if (!string.IsNullOrEmpty(value))
                        {
                            <i class="bi bi-telephone ms-2 text-muted"></i>
                        }
                    </div>
                }
                else if (field == "SessionizeUrl" || field == "HeadshotUrl")
                {
                    @if (!string.IsNullOrEmpty(value))
                    {
                        <div>
                            <a href="@value" target="_blank" class="text-decoration-none">
                                @value <i class="bi bi-box-arrow-up-right ms-1"></i>
                            </a>
                        </div>
                    }
                    else
                    {
                        <div class="text-muted">Not provided</div>
                    }
                }
                else
                {
                    <div>@(value ?? "Not provided")</div>
                }
            </div>
        </div>
        <button type="button"
                class="btn btn-sm btn-outline-primary edit-btn ms-2"
                hx-get="/Account?handler=EditField&field=@field"
                hx-target="#@(fieldName)-container"
                hx-swap="innerHTML">
            <i class="bi bi-pencil me-1"></i>Edit
        </button>
    </div>
</div>

@functions {
    private string GetDisplayName(string field)
    {
        return field switch
        {
            "FirstName" => "First Name",
            "LastName" => "Last Name",
            "Email" => "Email Address",
            "PhoneNumber" => "Phone Number",
            "Bio" => "Biography",
            "Goals" => "Goals",
            "SessionizeUrl" => "Sessionize Profile URL",
            "HeadshotUrl" => "Profile Photo URL",
            "SpeakerTypeId" => "Speaker Type",
            _ => field
        };
    }

    private string? GetFieldValue(morespeakers.Pages.Account.IndexModel? model, string field)
    {
        if (model?.CurrentUser == null) return null;

        return field switch
        {
            "FirstName" => model.CurrentUser.FirstName,
            "LastName" => model.CurrentUser.LastName,
            "Email" => model.CurrentUser.Email,
            "PhoneNumber" => model.CurrentUser.PhoneNumber,
            "Bio" => model.CurrentUser.Bio,
            "Goals" => model.CurrentUser.Goals,
            "SessionizeUrl" => model.CurrentUser.SessionizeUrl,
            "HeadshotUrl" => model.CurrentUser.HeadshotUrl,
            "SpeakerTypeId" => model.CurrentUser.SpeakerTypeId.ToString(),
            _ => null
        };
    }
}