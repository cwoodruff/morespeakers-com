@model MoreSpeakers.Web.Pages.Profile.EditModel

@if (Model.HasValidationErrors && !string.IsNullOrEmpty(Model.ValidationMessage))
{
    <div class="alert alert-danger mb-3">
        <i class="bi bi-exclamation-triangle me-2"></i>@Model.ValidationMessage
    </div>
}
@if (!Model.HasValidationErrors && !string.IsNullOrEmpty(Model.SuccessMessage))
{
    <div class="alert alert-success mb-3">
        <i class="bi bi-check-circle me-2"></i>@Model.SuccessMessage
    </div>
}

<form hx-post="/Profile/Edit?handler=UpdateProfile" 
      hx-target="#tabContent" 
      hx-swap="innerHTML" 
      hx-indicator="#loadingSpinner">
      
    <div asp-validation-summary="ModelOnly" class="alert alert-danger" role="alert"></div>

    <!-- Basic Information -->
    <div class="row mb-4">
        <div class="col-12">
            <h5 class="border-bottom pb-2 mb-3">
                <i class="bi bi-person-badge me-2"></i>Basic Information
            </h5>
        </div>
        <div class="col-md-6 mb-3">
            <label asp-for="Input.FirstName" class="form-label"></label>
            <input asp-for="Input.FirstName" class="form-control" />
            <span asp-validation-for="Input.FirstName" class="text-danger"></span>
        </div>
        <div class="col-md-6 mb-3">
            <label asp-for="Input.LastName" class="form-label"></label>
            <input asp-for="Input.LastName" class="form-control" />
            <span asp-validation-for="Input.LastName" class="text-danger"></span>
        </div>
        <div class="col-md-6 mb-3">
            <label asp-for="Input.PhoneNumber" class="form-label"></label>
            <input asp-for="Input.PhoneNumber" class="form-control" />
            <span asp-validation-for="Input.PhoneNumber" class="text-danger"></span>
        </div>
        <div class="col-md-6 mb-3">
            <label asp-for="Input.SpeakerTypeId" class="form-label"></label>
            <select asp-for="Input.SpeakerTypeId" class="form-select">
                <option value="1" selected="@(Model.Input.SpeakerTypeId == 1)">New Speaker</option>
                <option value="2" selected="@(Model.Input.SpeakerTypeId == 2)">Experienced Speaker</option>
            </select>
            <span asp-validation-for="Input.SpeakerTypeId" class="text-danger"></span>
        </div>
    </div>

    <!-- Profile Details -->
    <div class="row mb-4">
        <div class="col-12">
            <h5 class="border-bottom pb-2 mb-3">
                <i class="bi bi-card-text me-2"></i>Profile Details
            </h5>
        </div>
        <div class="col-12 mb-3">
            <label asp-for="Input.Bio" class="form-label"></label>
            <textarea asp-for="Input.Bio" class="form-control" rows="4" 
                      placeholder="Tell others about yourself, your experience, and what you're passionate about..."></textarea>
            <span asp-validation-for="Input.Bio" class="text-danger"></span>
            <div class="form-text">Share your background, experience, and what makes you passionate about speaking.</div>
        </div>
        <div class="col-12 mb-3">
            <label asp-for="Input.Goals" class="form-label"></label>
            <textarea asp-for="Input.Goals" class="form-control" rows="3" 
                      placeholder="What are your speaking goals? What do you hope to achieve?"></textarea>
            <span asp-validation-for="Input.Goals" class="text-danger"></span>
            <div class="form-text">Describe your speaking goals and what you hope to achieve through mentorship.</div>
        </div>
    </div>

    <!-- Profile Photo -->
    <div class="row mb-4">
        <div class="col-12">
            <h5 class="border-bottom pb-2 mb-3">
                <i class="bi bi-camera me-2"></i>Profile Photo
            </h5>
        </div>
        <div class="col-12">
            <div id="headshotContainer">
                <partial name="_HeadshotUpload" model="Model" />
            </div>
        </div>
    </div>

    <!-- URLs and Links -->
    <div class="row mb-4">
        <div class="col-12">
            <h5 class="border-bottom pb-2 mb-3">
                <i class="bi bi-link-45deg me-2"></i>Professional Links
            </h5>
        </div>
        <div class="col-12 mb-3">
            <label asp-for="Input.SessionizeUrl" class="form-label"></label>
            <input asp-for="Input.SessionizeUrl" class="form-control" placeholder="https://sessionize.com/your-profile" />
            <span asp-validation-for="Input.SessionizeUrl" class="text-danger"></span>
            <div class="form-text">Link to your Sessionize speaker profile.</div>
        </div>
    </div>

    <!-- Expertise Areas -->
    <div class="row mb-4">
        <div class="col-12">
            <h5 class="border-bottom pb-2 mb-3">
                <i class="bi bi-gear-fill me-2"></i>Areas of Expertise
            </h5>
            <div class="form-text mb-3">Select the technologies and topics you're knowledgeable about.</div>
        </div>
        <div class="col-12">
            <div class="row">
                @foreach (var expertise in Model.AvailableExpertise)
                {
                    <div class="col-md-3 col-sm-6 mb-2">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" 
                                   name="Input.SelectedExpertiseIds" 
                                   value="@expertise.Id"
                                   id="expertise_@expertise.Id"
                                   @(Model.Input.SelectedExpertiseIds?.Contains(expertise.Id) == true ? "checked" : "") />
                            <label class="form-check-label" for="expertise_@expertise.Id">
                                @expertise.Name
                            </label>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>

    <!-- Social Media Links -->
    <div class="row mb-4">
        <div class="col-12">
            <h5 class="border-bottom pb-2 mb-3">
                <i class="bi bi-share me-2"></i>Social Media Links
            </h5>
            <div class="form-text mb-3">Add your social media profiles and professional links.</div>
        </div>
        <div class="col-12" id="socialMediaContainer">
            @for (int i = 0; i < 5; i++)
            {
                <div class="row mb-2">
                    <div class="col-md-4">
                        <input name="Input.SocialMediaPlatforms[@i]" 
                               class="form-control" 
                               placeholder="Platform (e.g., Twitter, LinkedIn)"
                               value="@(Model.Input.SocialMediaPlatforms?.ElementAtOrDefault(i) ?? "")" />
                    </div>
                    <div class="col-md-8">
                        <input name="Input.SocialMediaUrls[@i]" 
                               class="form-control" 
                               placeholder="URL (e.g., https://twitter.com/username)"
                               value="@(Model.Input.SocialMediaUrls?.ElementAtOrDefault(i) ?? "")" />
                    </div>
                </div>
            }
        </div>
    </div>

    <!-- Submit Button -->
    <div class="d-flex justify-content-between align-items-center">
        <div id="loadingSpinner" class="htmx-indicator">
            <div class="spinner-border spinner-border-sm me-2" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            Updating profile...
        </div>
        <button type="submit" class="btn btn-primary">
            <i class="bi bi-check2 me-2"></i>Update Profile
        </button>
    </div>
</form>