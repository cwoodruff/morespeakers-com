@model MoreSpeakers.Web.Pages.Profile.IndexModel

<!-- Profile Header Card -->
<div class="card mb-4">
    <div class="card-body">
        <div class="row">
            <div class="col-md-3 mb-3 d-flex justify-content-center align-items-center">
                @if (!string.IsNullOrEmpty(Model.UserProfile.HeadshotUrl))
                {
                    <img hx-preserve src="@Model.UserProfile.HeadshotUrl" alt="@Model.UserProfile.FullName"
                         class="object-fit-contain border image-thumbnail rounded float-start" style="width:9rem; height:9rem;">
                }
                else
                {
                    <div class="justify-content-center">
                        <i class="bi bi-person-fill text-muted" style="font-size: 9rem;"></i>
                    </div>
                }
            </div>
            <div class="col-md-9">
                <div class="d-flex align-items-start justify-content-between flex-wrap">
                    <div class="flex-grow-1">
                        <h2 class="mb-2">@Model.UserProfile.FullName</h2>
                        <div class="mb-3">
                            <span class="badge @(Model.UserProfile.IsNewSpeaker ? "bg-primary" : "bg-success") fs-6 px-3 py-2">
                                <i class="bi @(Model.UserProfile.IsNewSpeaker ? "bi-person-plus" : "bi-award") me-2"></i>
                                @(Model.UserProfile.IsNewSpeaker ? "New Speaker" : "Experienced Speaker")
                            </span>
                        </div>
                        @if (!string.IsNullOrEmpty(Model.UserProfile.Bio))
                        {
                            <p class="text-muted mb-0">@Model.UserProfile.Bio</p>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Goals Section -->
@if (!string.IsNullOrEmpty(Model.UserProfile.Goals))
{
    <div class="card mb-4">
        <div class="card-header">
            <h5 class="mb-0">
                <i class="bi bi-bullseye me-2"></i>Goals & Objectives
            </h5>
        </div>
        <div class="card-body">
            <p class="mb-0">@Model.UserProfile.Goals</p>
        </div>
    </div>
}

<!-- Expertise and Links Row -->
<div class="row">
    @if (Model.UserProfile.UserExpertise?.Any() == true)
    {
        <div class="col-md-@(Model.UserProfile.UserSocialMediaSites.Any() ? "6" : "12") mb-4">
            <div class="card h-100">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="bi bi-gear-fill me-2"></i>
                        Expertise Areas
                    </h5>
                </div>
                <div class="card-body">
                    <div class="d-flex flex-wrap gap-2">
                        @foreach (var ue in Model.UserProfile.UserExpertise)
                        {
                            <span class="badge rounded-pill text-bg-primary fw-light px-3 py-2">@ue.Expertise.Name</span>
                        }
                    </div>
                </div>
            </div>
        </div>
    }

    @if (Model.UserProfile.UserSocialMediaSites.Any())
    {
        <div class="col-md-@(Model.UserProfile.UserExpertise?.Any() == true ? "6" : "12") mb-4">
            <div class="card h-100">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="bi bi-link-45deg me-2"></i>
                        Social Links
                    </h5>
                </div>
                <div class="card-body">
                    <div class="d-flex flex-wrap gap-2">
                        @foreach (var userSocialMediaSite in Model.UserProfile.UserSocialMediaSites)
                        {
                            <a href="@userSocialMediaSite.UserUrl" target="_blank" class="btn btn-primary mb-2">
                                <i class="@userSocialMediaSite.SocialMediaSite.Icon"></i>
                                @userSocialMediaSite.SocialMediaSite.Name
                            </a>
                        }
                    </div>
                </div>
            </div>
        </div>
    }
</div>

<!-- Sessionize Url -->
@if (!string.IsNullOrEmpty(Model.UserProfile.SessionizeUrl))
{
    <div class="card mb-4">
        <div class="card-header">
            <h5 class="mb-0">
                <i class="bi bi-megaphone me-2"></i>Sessionize Speaker Profile
            </h5>
        </div>
        <div class="card-body">
            <a href="@Model.UserProfile.SessionizeUrl" target="_blank" class="btn btn-outline-primary">
                <i class="bi bi-box-arrow-up-right me-2"></i>View Sessionize Profile
            </a>
        </div>
    </div>
}

@if (User.Identity?.IsAuthenticated == true && Model.CanEdit)
{

}
else if (User.Identity?.IsAuthenticated == true)
{
    <!-- Contact/Mentorship Actions -->
    <div class="card mb-4">
        <div class="card-header">
            <h5 class="mb-0">
                <i class="bi bi-person-add me-2"></i>Connect with @Model.UserProfile.FirstName
            </h5>
        </div>
        <div class="card-body text-center">
            @if (Model.UserProfile is { IsExperiencedSpeaker: true })
            {
                <p class="card-text">
                    <strong>@Model.UserProfile.FirstName</strong> is an experienced speaker who can provide mentorship and guidance for your speaking journey.
                </p>
                <button class="btn btn-primary"
                        hx-post="/Mentorship/Requests"
                        hx-vals='{"mentorId": "@Model.UserProfile.Id"}'
                        hx-confirm="Request mentorship from @Model.UserProfile.FullName?"
                        hx-target="#mentorship-result"
                        hx-swap="innerHTML">
                    <i class="bi bi-person-plus me-2"></i>Request Mentorship
                </button>
            }
            else
            {
                <p class="card-text">
                    <strong>@Model.UserProfile.FirstName</strong> is a new speaker looking for guidance and mentorship opportunities.
                </p>
                <button class="btn btn-success"
                        hx-post="/Mentorship/Offer"
                        hx-vals='{"newSpeakerId": "@Model.UserProfile.Id"}'
                        hx-confirm="Offer mentorship to @Model.UserProfile.FullName?"
                        hx-target="#mentorship-result"
                        hx-swap="innerHTML">
                    <i class="bi bi-award me-2"></i>Offer Mentorship
                </button>
            }
            <div id="mentorship-result" class="mt-3"></div>
        </div>
    </div>
}
else
{
    <div class="card mb-4">
        <div class="card-body text-center">
            <h5 class="card-title">Connect with @Model.UserProfile.FirstName</h5>
            <p class="card-text">Sign in to request mentorship or connect with this speaker.</p>
            <a asp-area="Identity" asp-page="/Account/Login" class="btn btn-primary">
                <i class="bi bi-box-arrow-in-right me-2"></i>Sign In to Connect
            </a>
        </div>
    </div>
}

<!-- Profile Statistics -->
<div class="card mb-4">
    <div class="card-header">
        <h5 class="mb-0">
            <i class="bi bi-graph-up me-2"></i>Profile Statistics
        </h5>
    </div>
    <div class="card-body">
        <div class="row text-center">
            <div class="col-md-4">
                <div class="stat-item">
                    <div class="stat-number">@(Model.UserProfile.UserExpertise?.Count ?? 0)</div>
                    <div class="stat-label">Expertise Areas</div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="stat-item">
                    <div class="stat-number">@(Model.UserProfile.UserSocialMediaSites.Count)</div>
                    <div class="stat-label">Social Links</div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="stat-item">
                    <div class="stat-number">@Model.UserProfile.CreatedDate.ToString("MMM yyyy")</div>
                    <div class="stat-label">Member Since</div>
                </div>
            </div>
        </div>
    </div>
</div>

@if (Model.CanEdit && Model.UserProfile.UserExpertise?.Any() !=true && Model.UserProfile.UserSocialMediaSites?.Any() != true)
{
    <!-- Complete Profile if expertise/social is missing -->
    <div class="card">
        <div class="card-body text-center py-5">
            <i class="bi bi-info-circle display-4 text-muted mb-3"></i>
            <h5 class="text-muted">Complete Your Profile</h5>
            <p class="text-muted mb-3">Add expertise areas and social links to help others connect with you.</p>
            <a asp-page="~/Profile/Edit" class="btn btn-primary">
                <i class="bi bi-pencil me-2"></i>Edit Profile
            </a>
        </div>
    </div>
}
